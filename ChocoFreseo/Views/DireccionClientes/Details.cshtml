@model ChocoFreseo.Models.Domain.DireccionCliente

@{
    ViewData["Title"] = "Detalles de dirección";
}

<div class="row">
    <div class="col-12 col-lg-6 mb-3">
        <div class="card">
            <div class="card-body">
                <h2 class="mb-1">Detalles de dirección</h2>
                <p class="text-muted mb-3">
                    Información registrada para esta dirección.
                </p>

                <dl class="row mb-0">
                    <dt class="col-sm-4">Cliente</dt>
                    <dd class="col-sm-8">@Model.Cliente?.NombreCompleto</dd>

                    <dt class="col-sm-4">Barrio</dt>
                    <dd class="col-sm-8">@Model.Barrio</dd>

                    <dt class="col-sm-4">Calle / Vía</dt>
                    <dd class="col-sm-8">@Model.Calle</dd>

                    <dt class="col-sm-4">Número</dt>
                    <dd class="col-sm-8">@Model.Numero</dd>

                    <dt class="col-sm-4">Referencia</dt>
                    <dd class="col-sm-8">@Model.Referencia</dd>

                    <dt class="col-sm-4">Principal</dt>
                    <dd class="col-sm-8">
                        @if (Model.EsPrincipal)
                        {
                            <span class="badge bg-success">Principal</span>
                        }
                        else
                        {
                            <span class="badge bg-secondary">Secundaria</span>
                        }
                    </dd>

                    <dt class="col-sm-4">Latitud</dt>
                    <dd class="col-sm-8">@Model.Latitud</dd>

                    <dt class="col-sm-4">Longitud</dt>
                    <dd class="col-sm-8">@Model.Longitud</dd>
                </dl>

                <div class="mt-3 d-flex gap-2">
                    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">Editar</a>
                    <a asp-action="Index" class="btn btn-secondary">Volver al listado</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Mapa -->
    <div class="col-12 col-lg-6 mb-3">
        <div class="card">
            <div class="card-body">
                <h5 class="mb-2">Mapa de ubicación</h5>
                @if (Model.Latitud.HasValue && Model.Longitud.HasValue)
                {
                    <div id="map-detalle-direccion" style="height: 360px; border-radius: 10px; border: 2px solid #E53935;"></div>
                    <small class="text-muted d-block mt-2">
                        Ubicación aproximada de la dirección registrada.
                    </small>
                }
                else
                {
                    <p class="text-muted mb-0">
                        Esta dirección aún no tiene coordenadas registradas.
                    </p>
                }
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @if (Model.Latitud.HasValue && Model.Longitud.HasValue)
    {
        <script>
            var lat = @Model.Latitud.Value.ToString(System.Globalization.CultureInfo.InvariantCulture);
            var lng = @Model.Longitud.Value.ToString(System.Globalization.CultureInfo.InvariantCulture);

            var map = L.map('map-detalle-direccion').setView([lat, lng], 15);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
            }).addTo(map);

            L.marker([lat, lng]).addTo(map);
        </script>
    }
}
